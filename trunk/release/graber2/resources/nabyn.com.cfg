*preinstalled=0

[main]
$main.url = 'http://www.nabyn.com/';
$main.icon = 'nabyn.com.bmp';
$picture.fields(preview,post_url);
$main.short = 'nbyn';

$main.checkcookie = '';
$userstring = 'user';
$pwdstring = 'pass';
$main.login = '$main.url+"users/f_login.php?"+$userstring+"="+$login+"&"+$pwdstring+"="+$password+"&user[remember_me]=1&ip_lock=0"';
$main.pagebypage = 1;

@addfield("searchmode","Searching mode",0,"indexlistbox","Tags","Browse");
@addfield("pictype","Picture Type",0,"indexlistbox","All","Completed Works","Sketches","WIPs");
@addfield("media","Media",0,"indexlistbox","All","Digital","Traditional","Other");
@addfield("style","Style",0,"indexlistbox","All","Anime/Manga","Cartoon","Realism","Semi-Realism","Abstract","Other");
@addfield("subject","Subject",0,"indexlistbox","All","People","Political","Design","Animals","Technology","Fantasy","Bandwagon","Anthro","Nature","Scenery","Still Life","Fanart","Other","Meme");
@addfield("blood","Blood",0,"indexlistbox","Show All","None","Some Blood","Excess and/or Gore");
@addfield("nudity","Nudity",0,"indexlistbox","Show All","None","Partial Nudity","Full Nudity");
@addfield("sexual","Sexual Themes",0,"indexlistbox","Show All","None","Contains");
@addfield("adult","Adult Themes",0,"indexlistbox","Show All","None","Some Smoking/Alcohol Use","Excess Smoking/Alcohol and/or Drug Use");

$picsperpage = 20;

[listscript]
?($searchmode=0){
	$thread.url = "$main.url+'tags.php?tag='+@httpencode($tag)+'&page='+$thread.counter";
	$thread.xml = 'xmlscript';
}
?($searchmode=1){
	$thread.url = "$main.url+'browse.php?pt='+$pictype+'&me='+$media+'&st='+$style+'&su='+$subject+'&blood='+$blood+'&nudity='+$nudity+'&sthemes='+$sexual+'&athemes='+$adult+'&page='+$thread.counter";
	$thread.xml = 'xmlbrowsescript';
}

@thread.execute();

[dwscript]
$thread.url = '$picture%post_url';
$thread.referer = $picture%post_url;
$thread.xml = 'dwxml';
$thread.execute();


[dwxml]

^div#id='viewlargediv'{
	$thread.url = '';
	^a{
		$thread.url = $main.url + @urlvar("image",#href);
	}
	?$thread.url = ''{
		^img{
			$thread.url = #src;
		}
	}
}

[xmlscript]
$href = '';
^table#class='art_desc'{
	^a{
		$href = #href;
		
		^img#class='imageshadow'{
			addpicture(%post_url=$href,
				%preview=#src);
			$picture.filename = @emptyname($picture%post_url) + '.' + @getext($picture%preview);
		}
	}
}

^table#class='p_th'{
	^a{
		$thread.count = @isempty(@urlvar("page",#href),0) + 1;
	}
}

[xmlbrowsescript]
$href = '';
^table#class='p_th'{
	^span#class='f12'{
		^a{
			$thread.count = @isempty(@urlvar("page",#href),0) + 1;
		}
	}
	^a{
		$href=#href;
		^img#class='imageshadow'{
			addpicture(%post_url=$href,
				%preview=#src);
			$picture.filename = @emptyname($picture%post_url) + '.' + @getext($picture%preview);
		}
	}
}